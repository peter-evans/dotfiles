#!/usr/bin/env bash
#
# Updates and installs dotfiles

set -euo pipefail

# Resolve symlinks to find actual script location
script_path="${BASH_SOURCE[0]}"
while [ -L "$script_path" ]; do
    script_dir="$(cd -P "$(dirname "$script_path")" && pwd)"
    script_path="$(readlink "$script_path")"
    [[ $script_path != /* ]] && script_path="$script_dir/$script_path"
done
dotfiles_dir="$(cd -P "$(dirname "$script_path")/.." && pwd)"

# shellcheck source=../lib/utils.sh
source "$dotfiles_dir/lib/utils.sh"

main() {

    echo "Updating dotfiles..."
    cd "$dotfiles_dir" && git pull

    echo "Installing dotfiles..."
    cd "$dotfiles_dir" && ./install.sh
}

main "$@"
